<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Current Sprint | Goalpost</title>
	<link rel="stylesheet" type="text/css" href="style.css">
	<link rel="manifest" href="/site.webmanifest">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body onload="onPageLoad()">
  <div class="accounts-list"></div>

  <script src="https://cdn.plaid.com/link/v2/stable/link-initialize.js"></script>
  <script>

	async function onPageLoad()
	{
		/*var handler = Plaid.create({
			apiVersion: 'v2',
			clientName: 'Goalpost',
			env: '{{PLAID_ENV}}',
			product: ['transactions'],
			key: '{{PLAID_PUBLIC_KEY}}',
			onSuccess: function(public_token) {
				$.post('/get_access_token', {
				public_token: public_token
				}, function() {
					$('#app').fadeIn('slow');
				});
			},
		});*/

		/*$('#link-btn').on('click', function(e) {
			handler.open();
		});*/

		const res = await fetch("/accounts", {
			method: "GET"
		});

		const resData = await res.json();
		const accountsList = document.querySelector(".accounts-list");

		for (let account of resData.accounts)
		{
			const accountInfoBox = document.createElement("div");
			accountInfoBox.className = "card account";
			accountInfoBox.innerHTML = `<strong>${account.name} $${account.balances.available != null ? account.balances.available : account.balances.current}</strong><br>${account.subtype} ${account.mask}`;
			accountsList.appendChild(accountInfoBox);
		}
	}
  </script>
</body>
</html>
